import{k as K,r as g,d as M,c as h,u as o,l as V,f as v,a as p,w as D,F as P,o as c,Z as T,b as e,t as r,g as m,i as z,e as W,n as x,h as Z,m as I,v as G,s as H,x as J,O as R,p as Q,j as X}from"./app-db97278d.js";import{_ as Y}from"./AdminLayout-8e0f8360.js";import{P as ee}from"./Pagination-e186959c.js";import te from"./CreateCurrency-aa43f199.js";import se from"./EditCurrency-a8f026e5.js";import{_ as U}from"./Spinner-c1a705af.js";import{D as oe}from"./DeleteIcon-2175ee8f.js";import{E as ae}from"./EditIcon-ba38440d.js";import{u as le}from"./useAPI-5d208629.js";import{u as re}from"./sorting-acdd0b76.js";import{u as ne}from"./notification-acac295e.js";import{_ as ie}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as ce}from"./TextInput-23d29fe4.js";import"./ResponsiveNavLink-3932dd1a.js";import"./FlashMessage-f6516a28.js";import"./CustomSidebar-7abc467c.js";import"./SidebarElement-2b51bfcd.js";import"./SelectInput-941874a0.js";import"./Modal-54842544.js";/* empty css                                                */const E=u=>(Q("data-v-f5b0e6e1"),u=u(),X(),u),de=E(()=>e("title",null,`
            Currencies
        `,-1)),ue={class:"ml-4 md:ml-8 mr-4 md:mr-8"},pe={class:"mt-16 mb-8 text-xl flex items-center justify-between"},me=E(()=>e("div",null," Currencies ",-1)),fe={class:"text-sm"},_e={class:"flex items-center"},be={key:0,class:"mb-8"},ge={class:"flex items-end gap-3"},he={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},ve={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},xe={class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},ye={class:"fw-100"},ke={class:"fw-100"},we={class:"fw-100"},Ce={class:"px-6 py-3",scope:"col"},Se={class:"fw-100"},$e={class:"px-6 py-3",scope:"col"},Ve={class:"fw-100"},Ie={class:"fw-100"},Re=E(()=>e("th",{class:"px-6 py-3",scope:"col"}," Actions ",-1)),Ee={class:"px-6 py-4"},qe={class:"px-6 py-4"},De={class:"px-6 py-4"},Pe={class:"px-6 py-4"},Ue=["id","onUpdate:modelValue","onChange"],Fe=["for"],Le=["onUpdate:modelValue"],Ne={class:"px-6 py-4 uppercase"},je={class:"px-6 py-4 flex gap-4 items-center"},Ae={name:"Currencies/Index"},Be=Object.assign(Ae,{props:{currencies:{required:!0,type:Object},info:{type:Object,default:""}},setup(u){const n=u,d=le(),y=ne(),w=K({});var f=g(!1),C=g();const F=t=>(w.value={...t},C.value=n.currencies.data.findIndex(a=>a.id===w.value.id),console.log(" index.value",C.value),f.value=!0,{showEditDialog:f});function L(t){return console.log("$isFetchData",t),t&&n.currencies.data.splice(C.value,1,t),f.value=!1,{showEditDialog:f}}const N=t=>{console.log("currency",t),t.toggleStatus?(t.updatedRate=t.toggleStatus?t.special_rate:t.rate,t.rate_source="special"):(t.updatedRate=t.toggleStatus?t.special_rate:t.rate,t.rate_source="world_bank")},j=()=>{n.currencies.total++},A=async t=>{deletingCurrencyId.value=t.id,d.startRequest();try{const a=await axios.delete("/admin/currencies/delete/"+t.id);(a.data.id||a.data.status==="success")&&(y.notify("Currency deleted","success"),t.id="deleted",n.currencies.total--)}catch(a){y.notify("Error, this base currency can not be deleted.","error"),d.handleErrors(a)}finally{d.requestCompleted()}},S=g(!1),B=async()=>{d.startRequest(),S.value=!0;try{const t=await axios.put("/admin/currencies/update-rates");t.data.status==="success"&&(y.notify("Currency rates updated","success"),n.currencies.data=t.data.currencies,n.info.fetched_at=t.data.fetched_at)}catch(t){y.notify("Error, could not fetch world bank rates.","error"),d.handleErrors(t)}finally{S.value=!1,d.requestCompleted()}};var $=g(1);let i=g("");const q=()=>{R.visit(`?page=${$.value}&q=${i.value}&column=${l.column}&type=${l.type}`)};var _=g(!1);const l=re(),k=t=>{i.value=i.value!=null?i.value:"",_.value=!0,l.sortValues(t),R.visit(`?page=${$.value}&q=${i.value}&column=${l.column}&type=${l.type}`)&&(_.value=!1)},O=()=>{R.visit("?q=")};return M(()=>{i.value=new URLSearchParams(window.location.search).get("q");let t=new URLSearchParams(window.location.search).get("page");$.value=t??1}),(t,a)=>(c(),h(P,null,[o(f)?(c(),V(se,{key:0,show:o(f),currencyData:w,onClose:a[0]||(a[0]=s=>L(s))},null,8,["show","currencyData"])):v("",!0),p(o(T),{title:"Currencies"},{default:D(()=>[de]),_:1}),p(Y,null,{default:D(()=>[e("div",ue,[e("div",pe,[me,e("div",fe," Page: "+r(n.currencies.current_page)+" | total: "+r(n.currencies.total)+" | from: "+r(n.currencies.from)+", to: "+r(n.currencies.to),1)]),p(te,{onCurrencyAdded:j}),e("div",_e,[e("button",{onClick:B,type:"button",class:"mb-8 flex items-center text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800"},[m(" Fetch world bank rates "),o(d).isLoading.value&&S.value?(c(),V(U,{key:0,class:"ml-3 button-spinner-center action-btn"})):v("",!0)]),u.info.fetched_at?(c(),h("div",be," Last fetched: "+r(u.info.fetched_at),1)):v("",!0)]),e("div",ge,[p(ce,{modelValue:o(i),"onUpdate:modelValue":a[1]||(a[1]=s=>z(i)?i.value=s:i=s),class:"mb-8",label:"Search by currency code",placeholder:"Search",title:"searchValue",onKeyup:W(q,["enter"])},null,8,["modelValue","onKeyup"]),e("button",{onClick:q,type:"button",class:"mb-8 flex items-center text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800"}," Search "),o(i)?(c(),h("button",{key:0,onClick:O,type:"button",class:"mb-8 flex items-center text-blue-700 bg-white border border-blue-700 hover:bg-gray-100 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800"}," Clear ")):v("",!0)]),e("div",he,[e("table",ve,[e("thead",xe,[e("tr",null,[e("th",{class:x(["px-6 py-3 cursor-pointer",o(_)?"disabled":"clickable"]),scope:"col",onClick:a[2]||(a[2]=s=>k("name"))},[m(" Country "),e("span",ye,r(o(l).column=="name"?"("+o(l).type+")":""),1)],2),e("th",{class:x(["px-6 py-3 cursor-pointer",o(_)?"disabled":"clickable"]),scope:"col",onClick:a[3]||(a[3]=s=>k("code"))},[m(" Currency Code "),e("span",ke,r(o(l).column=="code"?"("+o(l).type+")":""),1)],2),e("th",{class:x(["px-6 py-3 cursor-pointer",o(_)?"disabled":"clickable"]),scope:"col",onClick:a[4]||(a[4]=s=>k("name"))},[m(" Currency name "),e("span",we,r(o(l).column=="name"?"("+o(l).type+")":""),1)],2),e("th",Ce,[m(" Switch "),e("span",Se,r(o(l).column=="role"?"("+o(l).type+")":""),1)]),e("th",$e,[m(" Rate "),e("span",Ve,r(o(l).column=="role"?"("+o(l).type+")":""),1)]),e("th",{class:x(["px-6 py-3 cursor-pointer",o(_)?"disabled":"clickable"]),scope:"col",onClick:a[5]||(a[5]=s=>k("rate_source"))},[m(" Rate source (WB/Special) "),e("span",Ie,r(o(l).column=="rate_source"?"("+o(l).type+")":""),1)],2),Re])]),e("tbody",null,[(c(!0),h(P,null,Z(n.currencies.data,s=>I((c(),h("tr",{key:s.id,class:"bg-white border-b dark:bg-gray-900 dark:border-gray-700"},[e("td",Ee,[e("span",null,r(s.country?s.country.label:"N/A"),1)]),e("td",qe,[e("span",null,r(s.code),1)]),e("td",De,[e("span",null,r(s.name),1)]),e("td",Pe,[I(e("input",{type:"checkbox",class:x([s.rate_source=="special"?"slider-checked":"","slider"]),id:"toggle_"+s.id,"onUpdate:modelValue":b=>s.toggleStatus=b,onChange:b=>N(s)},null,42,Ue),[[H,s.toggleStatus]]),e("label",{for:"toggle_"+s.id,class:"slider round"},null,8,Fe)]),e("td",null,[s.editing?I((c(),h("input",{key:0,type:"number",class:"w-20 text-black","onUpdate:modelValue":b=>s.rate=b},null,8,Le)),[[J,s.rate]]):v("",!0),e("span",null,r(s.rate_source=="special"?parseFloat(s.special_rate).toFixed(2):parseFloat(s.rate).toFixed(2)),1)]),e("td",Ne,[e("span",null,r(s.rate_source.replace("_"," ")),1)]),e("td",je,[p(oe,{onClick:b=>A(s),class:"w-8 hover:cursor-pointer hover:bg-red-600 hover:text-white rounded-md p-1"},null,8,["onClick"]),p(ae,{onClick:b=>F(s),class:"w-8 hover:cursor-pointer hover:bg-blue-600 hover:text-white rounded-md p-1"},null,8,["onClick"]),o(d).isLoading.value&&t.deletingCurrencyId===s.id?(c(),V(U,{key:0,class:"button-spinner-center action-btn"})):v("",!0)])])),[[G,s.id!=="deleted"]])),128))])])]),p(ee,{links:n.currencies.links},null,8,["links"])])]),_:1})],64))}}),nt=ie(Be,[["__scopeId","data-v-f5b0e6e1"]]);export{nt as default};
