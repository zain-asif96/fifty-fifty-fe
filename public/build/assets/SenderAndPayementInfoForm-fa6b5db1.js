import{r as b,A as ae,o as s,c as v,b as f,a as l,w as p,g as h,t as k,f as g,F as pe,h as fe,m as ve,P as ye,Q as _e,K as be,k as ge,d as Ve,u as a,l as U,H as W,O as X,n as Y}from"./app-db97278d.js";import{_ as Z,V as ee}from"./vue-tel-input-c423b696.js";import{u as he}from"./useAPI-5d208629.js";import{c as re}from"./countries-4c15b513.js";import{c as oe}from"./currencies_countries-fbccd8be.js";import{u as ke}from"./notification-acac295e.js";import{_ as d}from"./NewTextInput-f00b3737.js";import{_ as I}from"./FiftyText-b13f5419.js";import{_ as Ce}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as N}from"./NewSelectInput-293ca775.js";import{N as te}from"./NewActionButton-b46bcee5.js";import{_ as xe}from"./NewTextArea-c84646f3.js";import{_ as we}from"./Spinner-c1a705af.js";/* empty css                                                     *//* empty css                                                */const qe=["for"],Ue={key:0,class:"text-red-600"},Ie=["value"],Be={__name:"RadioButton",props:{modelValue:{required:!0,type:String,default:"bank"},options:{type:Array,required:!0},title:{type:String},label:{default:"",type:String},required:{type:Boolean,default:!1},customStyle:{type:Object,default:""}},emits:["update:modelValue"],setup(c){const B=c,i=b(B.options[0].value);return ae({get(){return B.checked},set(t){emit("update:checked",t)}}),(t,m)=>(s(),v("div",{class:"w-full flex flex-col justify-start relative fifty-form-input",style:_e(c.customStyle)},[f("label",{for:c.title,class:"w-fit inline-block mb-2"},[l(I,null,{default:p(()=>[h(k(c.label??"")+" ",1),c.required?(s(),v("span",Ue,"*")):g("",!0)]),_:1})],8,qe),f("div",null,[(s(!0),v(pe,null,fe(c.options,y=>(s(),v("label",{key:y.value},[ve(f("input",{type:"radio",value:y.value,"onUpdate:modelValue":m[0]||(m[0]=_=>i.value=_),onInput:m[1]||(m[1]=_=>t.$emit("update:modelValue",_.target.value))},null,40,Ie),[[ye,i.value]]),h(" "+k(y.label),1)]))),128))])],4))}},Ne=Ce(Be,[["__scopeId","data-v-076e96b4"]]),Se={class:"sender-info-form-wrapper"},Fe={class:"receiver-info-form-wrapper"},Oe={key:0,class:"receiver-gets-wrapper m-auto"},Te={class:"receiver-gets"},Ae={key:1,class:"amount"},$e={key:0,class:"receiver-gets-wrapper m-auto"},Ee={class:"receiver-gets"},Le={class:"amount"},Re={class:"action-buttons"},je={name:"SenderInfo"},or=Object.assign(je,{props:{transactionId:{required:!1,type:String},user:{default:null,type:Object},commissions:{default:null,type:Object},receivingCountries:{required:!0,default:[],type:Array}},emits:["stepChanged"],setup(c,{emit:B}){const i=c;console.log("commissions",i.commissions);const t=he(),m=ke(),y=be().props.geoDetails,_=b(!1),C=b(0),S=b(!1),F=b(!1),x=b([]),r=ge({first_name:"",country:y.country_code,last_name:"",email:"",phone:"",amount:"",amountTotal:"",currency:oe[y.country_code],receiver_first_name:"",receiver_last_name:"",receiver_email:"",receiver_phone:"",receiver_country:"",receiver_bank_id:"",receiver_account_number:"",receiver_branch_number:"",receiver_banking_info:"",flag:"send_now",type:"bank"}),le=async()=>{_.value=!0;const n=i.receivingCountries.find(e=>e.code_iso_2===r.receiver_country||e.code===r.receiver_country);try{const e=await axios.post("/api/convert-currency",{baseCurrency:r.currency,requiredCurrency:n.currency.code});C.value=e==null?void 0:e.data[n.currency.code].value}catch{m.notify("Exchange rate is not available at the moment..","error")}finally{_.value=!1}},ne=async n=>{n.preventDefault(),t.startRequest(),console.log("user",r),r.amountTotal=w.value.toString();try{(await axios.post("/api/validate-info",{...r,transactionId:i.transactionId})).data.status==="success"&&X.get("/verify-contacts?source="+(i.transactionId??"direct"))}catch(e){m.notify("Something went wrong...","error"),t.handleErrors(e)}finally{t.requestCompleted()}},O=ae(()=>parseFloat((C.value*r.amount).toFixed(2))),se=n=>{r.phone="+"+n.dialCode},ie=n=>{r.receiver_phone="+"+n.dialCode},ue=()=>{X.visit("/")};let w=b(0);function T(){F.value=!0;let n=parseFloat(r.amount);for(const e of i.commissions)console.log("props.commissions",i.commissions),n>parseFloat(e.from)&&n<=parseFloat(e.to)&&(console.log("range.amount)",e.amount),n=n+parseFloat(e.amount));return console.log("total",n),w.value=n,{totalValue:w}}const A=async()=>{t.startRequest();let n=r.receiver_country;console.log("country",n);try{const e=await axios.get("/api/get-international-banks?country_code="+n);console.log("res.banks",e),e.data.status=="success"&&(x.value=[],console.log("res.banks",e.banks),e.data.banks.forEach(u=>{x.value.push({label:u.label,value:u.id})}),console.log("bankoptions",x.value),le())}catch(e){m.notify("Something went wrong...","error"),t.handleErrors(e)}finally{t.requestCompleted()}};Ve(()=>{let n=route().params.amount,e=route().params.receiver_country,u=route().params.receiver_gets;r.amount=n||"",r.receiver_country=e||"",r.amount!=""&&T(),u!=""&&(C.value=u,O.value=u),r.receiver_country&&A()});const de=()=>{},ce=[{label:"Bank",value:"bank"},{label:"E-Money/Transfer",value:"transfer"}];return(n,e)=>{var u,$,E,L,R,j,D,P,M,z,J,G,H,K,Q;return s(),v("div",Se,[l(d,{modelValue:r.first_name,"onUpdate:modelValue":e[0]||(e[0]=o=>r.first_name=o),errors:(u=a(t).errors.value)==null?void 0:u.first_name,label:"First Name",placeholder:"John",required:"",title:"first_name",class:"sender-input"},null,8,["modelValue","errors"]),l(d,{modelValue:r.last_name,"onUpdate:modelValue":e[1]||(e[1]=o=>r.last_name=o),errors:($=a(t).errors.value)==null?void 0:$.last_name,label:"Last Name",placeholder:"Doe",required:"",title:"last_name",class:"sender-input"},null,8,["modelValue","errors"]),l(d,{modelValue:r.email,"onUpdate:modelValue":e[2]||(e[2]=o=>r.email=o),errors:(E=a(t).errors.value)==null?void 0:E.email,label:"Email",placeholder:"john@example.com",required:"",title:"email",class:"sender-input"},null,8,["modelValue","errors"]),l(Z,{errors:(L=a(t).errors.value)==null?void 0:L.phone,required:!0,label:"Phone Number",title:"phone",class:"sender-input"},{default:p(()=>{var o,V,q;return[l(a(ee),{id:"exampleFormControlInput1",ref:"input",modelValue:r.phone,"onUpdate:modelValue":e[3]||(e[3]=me=>r.phone=me),class:Y([{"error-border":((V=(o=a(t).errors.value)==null?void 0:o.phone)==null?void 0:V.length)>0},"form-control block w-full px-0 py-0 text-lg font-normal h-10 text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-linear m-0 focus:text-gray-700 focus:bg-white focus:border-indigo-300 focus:outline-none"]),defaultCountry:(q=a(y))==null?void 0:q.country_code,inputOptions:{placeholder:"123456789"},mode:"international",onCountryChanged:se},null,8,["modelValue","class","defaultCountry"])]}),_:1},8,["errors"]),l(d,{modelValue:r.amount,"onUpdate:modelValue":[e[4]||(e[4]=o=>r.amount=o),T],disabled:S.value,errors:(R=a(t).errors.value)==null?void 0:R.amount,label:"Amount",placeholder:"99",required:"",title:"amount",class:"fifty-form-input",type:"number"},null,8,["modelValue","disabled","errors"]),l(N,{modelValue:r.country,"onUpdate:modelValue":e[5]||(e[5]=o=>r.country=o),errors:(j=a(t).errors.value)==null?void 0:j.country,options:a(re),disabled:"",label:"Country",placeholder:"Country",required:"",title:"country",type:"text",class:"fifty-form-input"},null,8,["modelValue","errors","options"]),l(I,{variation:"heading-3"},{default:p(()=>[h(" Enter Receiver Information ")]),_:1}),f("div",Fe,[l(d,{class:"fifty-form-input",modelValue:r.receiver_first_name,"onUpdate:modelValue":e[6]||(e[6]=o=>r.receiver_first_name=o),errors:(D=a(t).errors.value)==null?void 0:D.receiver_first_name,label:"First Name",placeholder:"John",required:"",title:"first_name"},null,8,["modelValue","errors"]),l(d,{class:"fifty-form-input",modelValue:r.receiver_last_name,"onUpdate:modelValue":e[7]||(e[7]=o=>r.receiver_last_name=o),errors:(P=a(t).errors.value)==null?void 0:P.receiver_last_name,label:"Last Name",placeholder:"Doe",required:"",title:"last_name"},null,8,["modelValue","errors"]),l(d,{class:"fifty-form-input",modelValue:r.receiver_email,"onUpdate:modelValue":e[8]||(e[8]=o=>r.receiver_email=o),errors:(M=a(t).errors.value)==null?void 0:M.receiver_email,label:"Email",placeholder:"john@example.com",title:"email"},null,8,["modelValue","errors"]),l(Z,{errors:(z=a(t).errors.value)==null?void 0:z.receiver_phone,required:!1,label:"Phone Number",title:"phone",class:"fifty-form-input"},{default:p(()=>{var o,V;return[l(a(ee),{id:"exampleFormControlInput1",ref:"input",modelValue:r.receiver_phone,"onUpdate:modelValue":e[9]||(e[9]=q=>r.receiver_phone=q),class:Y([{"error-border":((V=(o=a(t).errors.value)==null?void 0:o.receiver_phone)==null?void 0:V.length)>0},"form-control block w-full px-0 py-0 text-lg font-normal h-10 text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-linear m-0 focus:text-gray-700 focus:bg-white focus:border-indigo-300 focus:outline-none"]),inputOptions:{placeholder:"123456789"},onlyCountries:S.value?[r.receiver_country]:[],mode:"international",onCountryChanged:ie},null,8,["modelValue","class","onlyCountries"])]}),_:1},8,["errors"]),l(Ne,{modelValue:r.type,"onUpdate:modelValue":[e[10]||(e[10]=o=>r.type=o),de],customStyle:{width:"inherit"},title:"Type",label:"Type",options:ce},null,8,["modelValue"]),l(N,{class:"fifty-form-input",modelValue:r.receiver_country,"onUpdate:modelValue":[e[11]||(e[11]=o=>r.receiver_country=o),A],errors:(J=a(t).errors.value)==null?void 0:J.receiver_country,options:a(re),label:"Country",placeholder:"Country",required:"",title:"country",type:"text"},null,8,["modelValue","errors","options"]),r.type=="bank"?(s(),U(N,{key:0,class:"fifty-form-input",modelValue:r.receiver_bank_id,"onUpdate:modelValue":e[12]||(e[12]=o=>r.receiver_bank_id=o),errors:(G=a(t).errors.value)==null?void 0:G.receiver_bank_id,options:x.value,label:"International Bank",placeholder:"International Bank",required:"",title:"bank",type:"text"},null,8,["modelValue","errors","options"])):g("",!0),r.type=="bank"?(s(),U(d,{key:1,class:"fifty-form-input",modelValue:r.receiver_account_number,"onUpdate:modelValue":e[13]||(e[13]=o=>r.receiver_account_number=o),errors:(H=a(t).errors.value)==null?void 0:H.receiver_account_number,label:"Account Number",placeholder:"123456789",required:"",title:"account_number"},null,8,["modelValue","errors"])):g("",!0),r.type=="bank"?(s(),U(d,{key:2,class:"fifty-form-input",modelValue:r.receiver_branch_number,"onUpdate:modelValue":e[14]||(e[14]=o=>r.receiver_branch_number=o),errors:(K=a(t).errors.value)==null?void 0:K.receiver_branch_number,label:"Branch Number",placeholder:"123456789",title:"branch_number"},null,8,["modelValue","errors"])):g("",!0),l(xe,{modelValue:r.receiver_banking_info,"onUpdate:modelValue":e[15]||(e[15]=o=>r.receiver_banking_info=o),errors:(Q=a(t).errors.value)==null?void 0:Q.receiver_banking_info,label:"Additional Information / Comments",placeholder:"I am open to different payment options...",title:"banking_info"},null,8,["modelValue","errors"])]),l(W,{mode:"out-in",name:"fade"},{default:p(()=>[C.value&&r.amount?(s(),v("div",Oe,[f("div",Te,[l(I,{class:"title"},{default:p(()=>[h(" The receiver will get approximately ")]),_:1}),_.value?(s(),U(we,{key:0})):(s(),v("div",Ae,k(a(O))+" "+k(a(oe)[r.receiver_country]),1))])])):g("",!0)]),_:1}),l(W,{mode:"out-in",name:"fade"},{default:p(()=>[F.value?(s(),v("div",$e,[f("div",Ee,[l(I,{class:"title"},{default:p(()=>[h(" Total Amount ")]),_:1}),f("div",Le,k(a(w)+" "+r.currency),1)])])):g("",!0)]),_:1}),f("div",Re,[l(te,{reversed:!0,type:"button",title:"Cancel",onClick:ue}),l(te,{isLoading:a(t).isLoading.value,title:"Continue",onClick:ne},null,8,["isLoading"])])])}}});export{or as default};
