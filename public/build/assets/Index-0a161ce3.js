import{o as f,c as w,b as e,k as M,r as v,d as T,u as a,l as I,f as C,a as d,w as x,F as D,Z as U,t as n,i as Z,e as G,n as h,g as u,h as H,z as S,O as V,p as J,j as Q}from"./app-db97278d.js";import{_ as W}from"./AdminLayout-8e0f8360.js";import X from"./Add-668fee60.js";import j from"./Edit-e21d9a89.js";import{P as Y}from"./Pagination-e186959c.js";import{u as ee}from"./sorting-acdd0b76.js";import{_ as te}from"./Spinner-c1a705af.js";import{D as se}from"./DeleteIcon-2175ee8f.js";import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";import{u as oe}from"./useAPI-5d208629.js";import{u as ae}from"./notification-acac295e.js";import{E as le}from"./EditIcon-ba38440d.js";import{_ as re}from"./TextInput-23d29fe4.js";import"./ResponsiveNavLink-3932dd1a.js";import"./FlashMessage-f6516a28.js";import"./CustomSidebar-7abc467c.js";import"./SidebarElement-2b51bfcd.js";import"./SelectInput-941874a0.js";import"./countries-4c15b513.js";import"./currencies-7c039667.js";import"./postStatus-c198e9db.js";/* empty css                                                */import"./Modal-54842544.js";const ne={name:"RefreshIcon"},ie={xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-clockwise",viewBox:"0 0 16 16"},ce=e("path",{"fill-rule":"evenodd",d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"},null,-1),de=e("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"},null,-1),ue=[ce,de];function pe(_,l,p,y,E,k){return f(),w("svg",ie,ue)}const me=z(ne,[["render",pe]]);const q=_=>(J("data-v-abb92eaf"),_=_(),Q(),_),fe=q(()=>e("title",null,`
            Posts
        `,-1)),ve={class:"ml-4 md:ml-8 mr-4 md:mr-8"},he={class:"mt-16 mb-8 text-xl flex items-center justify-between"},_e=q(()=>e("div",null," Posts ",-1)),be={class:"text-sm"},ge={class:"flex items-end gap-3"},ye={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},xe={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},we={class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},ke={class:"fw-100"},$e={class:"fw-100"},Ce={class:"fw-100"},Pe={class:"fw-100"},Ie={class:"fw-100"},Se={class:"fw-100"},Ve=q(()=>e("th",{class:"px-6 py-3",scope:"col"}," Actions ",-1)),qe={class:"px-6 py-4"},Ee={class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white",scope:"row"},Re={class:"px-6 py-3",scope:"col"},Ae={class:"px-6 py-3",scope:"col"},De={class:"px-6 py-3",scope:"col"},je={class:"uppercase"},ze={class:"px-6 py-3 uppercase",scope:"col"},Be={class:"px-6 py-3",scope:"col"},Le={name:"Posts/Index"},Ne=Object.assign(Le,{props:{posts:{required:!0,type:Object},receivers:{required:!0,type:Object}},setup(_){const l=_,p=oe(),y=ae();console.log("receivers",l.receivers);const E=s=>{console.log("data after adding ",s),l.posts.data.unshift(s.data),l.posts.total++},k=M({});var b=v(!1),i=v();const B=s=>(k.value={...s},i.value=l.posts.data.findIndex(t=>t.id===k.value.id),console.log(" index.value",i.value),b.value=!0,{showEditDialog:b,Edit:j});function L(s){return l.posts.data.splice(i.value,1,s),b.value=!1,i.value=null,{showEditDialog:b}}let $=v();const N=async s=>{console.log("post",s),$.value=s.id,i.value=l.posts.data.findIndex(t=>t.id===s.id),console.log("index.value",i.value),console.log("selectedPostId.value",$.value),p.startRequest();try{const t=await axios.post("/admin/posts/refresh/"+s.id);console.log("res refresh",t),t.data.status==="success"&&(y.notify("Post Refereshed","success"),l.posts.data.splice(i.value,1,t.data.data),i.value=null)}catch(t){y.notify("Error, this base post can not be refreshed.","error"),p.handleErrors(t)}finally{p.requestCompleted()}},O=async s=>{console.log(s),$.value=s.id,i.value=l.posts.data.findIndex(t=>t.id===s.id),console.log("index.value",i.value),p.startRequest();try{const t=await axios.delete("/admin/posts/delete/"+s.id);(t.data.id||t.data.status==="success")&&(y.notify("Post deleted","success"),s.id="deleted",l.posts.total--,l.posts.rows.splice(i.value,1),i.value=null)}catch(t){y.notify("Error, this base post can not be deleted.","error"),p.handleErrors(t)}finally{p.requestCompleted()}};v(!1);var P=v(1),c=v(""),m=v(!1);const r=ee(),g=s=>{c.value=c.value!=null?c.value:"",m.value=!0,r.sortValues(s),V.visit(`?page=${P.value}&q=${c.value}&column=${r.column}&type=${r.type}`)&&(m.value=!1)},R=()=>{V.visit(`?page=${P.value}&q=${c.value}&column=${r.column}&type=${r.type}`)},F=()=>{V.visit("?q=")};T(()=>{c.value=new URLSearchParams(window.location.search).get("q");let s=new URLSearchParams(window.location.search).get("page");P.value=s??1});function K(s){let t="info";return s=="available"?t="success":s=="on_hold"&&(t="danger"),t}return(s,t)=>(f(),w(D,null,[a(b)?(f(),I(j,{key:0,show:a(b),postData:k,onClose:t[0]||(t[0]=o=>L(o))},null,8,["show","postData"])):C("",!0),d(a(U),{title:"Posts"},{default:x(()=>[fe]),_:1}),d(W,null,{default:x(()=>[e("div",ve,[e("div",he,[_e,e("div",be," Page: "+n(l.posts.current_page)+" | total: "+n(l.posts.total)+" | from: "+n(l.posts.from)+", to: "+n(l.posts.to),1)]),d(X,{receivers:l.receivers,onPostAdded:E},null,8,["receivers"]),e("div",ge,[d(re,{modelValue:a(c),"onUpdate:modelValue":t[1]||(t[1]=o=>Z(c)?c.value=o:c=o),class:"mb-8",label:"Search by",placeholder:"Search",title:"searchValue",onKeyup:G(R,["enter"])},null,8,["modelValue","onKeyup"]),e("button",{onClick:R,type:"button",class:"mb-8 flex items-center text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800"}," Search "),a(c)?(f(),w("button",{key:0,onClick:F,type:"button",class:"mb-8 flex items-center text-blue-700 bg-white border border-blue-700 hover:bg-gray-100 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800"}," Clear ")):C("",!0)]),e("div",ye,[e("table",xe,[e("thead",we,[e("tr",null,[e("th",{class:h(["px-6 py-3",a(m)?"disabled":"clickable"]),scope:"col",onClick:t[2]||(t[2]=o=>g("created_at"))},[u(" Initialized "),e("span",ke,n(a(r).column=="created_at"?"("+a(r).type+")":""),1)],2),e("th",{class:h(["px-6 py-3",a(m)?"disabled":"clickable"]),scope:"col",onClick:t[3]||(t[3]=o=>g("status"))},[u(" Status "),e("span",$e,n(a(r).column=="status"?"("+a(r).type+")":""),1)],2),e("th",{class:h(["px-6 py-3",a(m)?"disabled":"clickable"]),scope:"col",onClick:t[4]||(t[4]=o=>g("user"))},[u(" Country from "),e("span",Ce,n(a(r).column=="user"?"("+a(r).type+")":""),1)],2),e("th",{class:h(["px-6 py-3",a(m)?"disabled":"clickable"]),scope:"col",onClick:t[5]||(t[5]=o=>g("receiver"))},[u(" Country To "),e("span",Pe,n(a(r).column=="receiver"?"("+a(r).type+")":""),1)],2),e("th",{class:h(["px-6 py-3",a(m)?"disabled":"clickable"]),scope:"col",onClick:t[6]||(t[6]=o=>g("amount"))},[u(" Amount "),e("span",Ie,n(a(r).column=="amount"?"("+a(r).type+")":""),1)],2),e("th",{class:h(["px-6 py-3",a(m)?"disabled":"clickable"]),scope:"col",onClick:t[7]||(t[7]=o=>g("id"))},[u(" Direct Transaction Reference "),e("span",Se,n(a(r).column=="id"?"("+a(r).type+")":""),1)],2),Ve])]),e("tbody",null,[(f(!0),w(D,null,H(l.posts.data,o=>(f(),w("tr",{key:o.id,class:"bg-white border-b dark:bg-gray-900 dark:border-gray-700"},[e("td",qe,n(o.created_at),1),e("td",Ee,[e("span",{class:h(K(o.status))},n(o.status),3)]),e("td",Re,[e("p",null,n(o.transaction.user.country),1),e("p",null,[d(a(S),{href:s.route("single.user.page",o.transaction.user.id),class:"text-blue-700 hover:text-blue-900 hover:underline"},{default:x(()=>[u(" (View sender) ")]),_:2},1032,["href"])])]),e("td",Ae,[e("p",null,n(o.transaction.receiver.country),1),e("p",null,[d(a(S),{href:s.route("single.receiver.page",o.transaction.receiver.id),class:"text-blue-700 hover:text-blue-900 hover:underline"},{default:x(()=>[u(" (View receiver) ")]),_:2},1032,["href"])])]),e("td",De,[e("p",null,[u(n(parseFloat(o.transaction.payment_intent.amount/100).toFixed(2))+" ",1),e("span",je," ("+n(o.transaction.payment_intent.currency)+") ",1)]),d(a(S),{href:s.route("payment.intent.page",o.transaction.payment_intent.id),class:"text-blue-700 hover:text-blue-900 hover:underline"},{default:x(()=>[u(" (View Payment Intent) ")]),_:2},1032,["href"])]),e("td",ze," #"+n(o.transaction.id),1),e("td",Be,[d(se,{onClick:A=>O(o),class:"w-8 hover:cursor-pointer hover:bg-red-600 hover:text-white rounded-md p-1"},null,8,["onClick"]),d(le,{onClick:A=>B(o),class:"w-8 hover:cursor-pointer hover:bg-green-600 hover:text-white rounded-md p-1"},null,8,["onClick"]),o.status=="on_hold"?(f(),I(me,{key:0,onClick:A=>N(o),class:"w-8 hover:cursor-pointer hover:bg-blue-600 hover:text-white rounded-md p-1"},null,8,["onClick"])):C("",!0),a(p).isLoading.value&&a($).value===o.id?(f(),I(te,{key:1,class:"button-spinner-center action-btn"})):C("",!0)])]))),128))])])]),d(Y,{links:l.posts.links},null,8,["links"])])]),_:1})],64))}}),ct=z(Ne,[["__scopeId","data-v-abb92eaf"]]);export{ct as default};
