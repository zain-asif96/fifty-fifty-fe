import{_ as B}from"./Spinner-c1a705af.js";import{o as r,c as s,b as y,l as L,f as _,r as f,a as m,w as j,u as i,t as S,g as k}from"./app-db97278d.js";import{u as V}from"./useAPI-5d208629.js";import{u as $}from"./notification-acac295e.js";import{u as q}from"./useHelpers-046d81e5.js";import{_ as E}from"./FiftyText-b13f5419.js";import{N as w}from"./NewActionButton-b46bcee5.js";/* empty css                                                */import"./countries-4c15b513.js";import"./_plugin-vue_export-helper-c27b6911.js";const O={class:"flex items-center justify-center w-full max-w-2xl relative"},R={name:"FileInput"},D=Object.assign(R,{props:{isLoading:{type:Boolean,default:!1}},emits:["file-changed"],setup(l,{emit:c}){const o=e=>{c("file-changed",e.target.files[0])};return(e,n)=>(r(),s("div",O,[y("input",{id:"file_input",class:"block w-full border border-gray-400 p-2 rounded-md text-lg text-gray-900 cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700",type:"file",onChange:o},null,32),l.isLoading?(r(),L(B,{key:0,class:"absolute right-5"})):_("",!0)]))}}),F=y("span",{class:"text-base"},"(PNG, JPG, SVG)",-1),G={key:1,class:"proof-wrapper"},T=["src"],A={key:0,class:"action-buttons"},I={key:2,class:"text-left mt-1 text-red-500 text-base"},H={name:"UploadPaymentProof"},te=Object.assign(H,{props:{url:{type:String,required:!0},transaction:{type:Object,required:!0}},emits:["uploaded"],setup(l,{emit:c}){const o=l,e=V(),n=$(),P=q(),g=f(o.transaction.payment_intent.payment_proof),p=f(o.transaction.payment_intent.payment_proof),d=f(o.transaction.payment_intent.payment_proof);let u=null;const U=async()=>{e.startRequest();const t=new FormData;t.append("payment_proof_file",u),t.append("transaction_id",o.transaction.id),t.append("payment_intent_id",P.getURLParam("payment-reference-identification"));const v={headers:{"Content-Type":"multipart/form-data"}};try{const a=await axios.post(o.url,t,v);a.data.status==="success"?(n.notify("Payment proof uploaded.","success"),c("uploaded",a.data.transaction),g.value=!0):n.notify(a.data.status.message??"Error while uploading.","error")}catch(a){e.handleErrors(a),n.notify("Error while uploading.","error")}finally{e.requestCompleted()}},C=t=>{p.value=!0,t&&(d.value=URL.createObjectURL(t),u=t)},N=()=>{p.value=!1,d.value="",u=null};return(t,v)=>{var a,h,x,b;return r(),s("div",null,[m(E,{variation:"body-xl",color:"dark",class:"mb-4"},{default:j(()=>[k(" Please, upload a clear image "),F,k(" of the payment proof. ")]),_:1}),p.value?(r(),s("div",G,[y("img",{src:d.value,alt:"payment proof",class:"max-w-sm"},null,8,T),g.value?_("",!0):(r(),s("div",A,[m(w,{"is-loading":i(e).isLoading.value,onClick:U,title:"Upload"},null,8,["is-loading"]),m(w,{reversed:!0,onClick:N,title:"Cancel"})]))])):(r(),L(D,{key:0,isLoading:i(e).isLoading.value,onFileChanged:C},null,8,["isLoading"])),(h=(a=i(e).errors)==null?void 0:a.value)!=null&&h.payment_proof_file?(r(),s("div",I,S((b=(x=i(e).errors)==null?void 0:x.value)==null?void 0:b.payment_proof_file[0]),1)):_("",!0)])}}});export{te as default};
