import{u as y}from"./notification-acac295e.js";import{u as V}from"./useAPI-5d208629.js";import b from"./ResendEmailCode-73ca8ebe.js";import{r as u,c as C,b as f,a as r,u as s,O as p,o as h}from"./app-db97278d.js";import{N as m}from"./NewActionButton-b46bcee5.js";import{_ as k}from"./NewTextInput-f00b3737.js";import"./Spinner-c1a705af.js";/* empty css                                                */import"./_plugin-vue_export-helper-c27b6911.js";import"./FiftyText-b13f5419.js";/* empty css                                                     */const w={class:"verify-code-form-wrapper"},x={class:"code-input"},B={class:"action-buttons"},N={name:"VerifyCode"},T=Object.assign(N,{props:{user:{default:null,type:Object}},emits:["verified"],setup(v,{emit:_}){const l=v,o=V();let t=u(!!l.user.email_verified_at||!!l.user.phone_verified_at);const a=u(""),n=y(),g=async()=>{o.startRequest();try{const i=await axios.post("/api/verify-user",{code:a.value});console.log("res",i),i.data.status==="valid"?(t.value=!0,console.log("isVerified",t.value),n.notify("Verified","success"),_("verified")):(o.errors.value.verificationCode=["Invalid code"],n.notify("Invalid code","error"))}catch(i){let e="Invalid code";i.response.status===419&&(p.get("/user-info",{message:"session expired"},{preserveState:!1}),e="Session expired, please reload the page.",setTimeout(()=>{window.location="/user-info"},1e3)),n.notify(e,"error"),o.handleErrors(i)}finally{o.requestCompleted()}};return(i,e)=>{var d;return h(),C("div",w,[f("div",x,[r(k,{modelValue:a.value,"onUpdate:modelValue":e[0]||(e[0]=c=>a.value=c),errors:(d=s(o).errors.value)==null?void 0:d.code,label:"Verification code",placeholder:"6-digit code",required:"",title:"verificationCode"},null,8,["modelValue","errors"]),r(b)]),f("div",B,[r(m,{title:"Back",reversed:!0,onClick:e[1]||(e[1]=c=>s(p).get("/user-info"))}),r(m,{title:"Verify",isLoading:s(o).isLoading.value,disabled:s(t)==!0?"disabled":"",onClick:g},null,8,["isLoading","disabled"])])])}}});export{T as default};
